# Welcome to your prefect.yaml file! You can use this file for storing and managing
# configuration for deploying your flows. We recommend committing this file to source
# control along with your flow code.

# Generic metadata about this project
name: pxinfra
prefect-version: 3.0.4

# build section allows you to manage and build docker images
build:

# push section allows you to manage if and how this project is uploaded to remote locations
push:

# pull section allows you to provide instructions for cloning this project in remote locations
pull:
- prefect.deployments.steps.run_shell_script:
    id: install-poetry
    script: pip install poetry
    stream_output: true
- prefect.deployments.steps.git_clone:
    id: clone-step
    repository: ssh://git@git.pantopix.net:3300/infrastructure/pxknowledge-graph.git
    branch: main
    access_token: '{{ prefect.blocks.secret.deployment-bafa-flow-run-bafa-flow-repo-token}}'
- prefect.deployments.steps.run_shell_script:
    id: generate-requirements-txt
    directory: "{{ clone-step.directory }}"
    script: poetry export --only main --without-hashes --output requirements.txt
    stream_output: true
- prefect.deployments.steps.pip_install_requirements:
    directory: "{{ clone-step.directory }}"
    requirements_file: requirements.txt
    stream_output: true

# the deployments section allows you to provide configuration for deploying flows
deployments:
- name: export-import-repos-c5-ke1
  version:
  tags: []
  concurrency_limit:
  description:
  entrypoint: pxgraphdb.py:export_import_repos_c5_ke1
  parameters:
    repos: ['Vestas-demo']
  work_pool:
    name: build
    work_queue_name:
    job_variables: {}
  enforce_parameter_schema: true
  schedules: []
- name: export-import-repos-graphs-c5-ke1
  version:
  tags: []
  concurrency_limit:
  description:
  entrypoint: pxgraphdb.py:export_import_repos_graphs_c5_ke1
  parameters:
    src_repo: Consumption-Navigator-001
    graphs: ['https://data.kaeser.com/KKH/GPH']
    tgt_repo: Vestas-demo
  work_pool:
    name: mercur
    work_queue_name:
    job_variables: {}
  enforce_parameter_schema: true
  schedules: []
- name: export-import-repos-ke1-ke-test
  version:
  tags: []
  concurrency_limit:
  description:
  entrypoint: pxgraphdb.py:export_import_repos_ke1_ke_test
  parameters:
    repos: ['Vestas-demo']
  work_pool:
    name: mercur
    work_queue_name:
    job_variables: {}
  enforce_parameter_schema: true
  schedules: []
- name: export-import-repos-graphs-ke1-ke-test
  version:
  tags: []
  concurrency_limit:
  description:
  entrypoint: pxgraphdb.py:export_import_repos_graphs_ke1_ke_test
  parameters:
    src_repo: Consumption-Navigator-001
    graphs: ['https://data.kaeser.com/KKH/GPH']
    tgt_repo: Vestas-demo
  work_pool:
    name: mercur
    work_queue_name:
    job_variables: {}
  enforce_parameter_schema: true
  schedules: []
- name: export-import-repos-c5-ke2
  version:
  tags: []
  concurrency_limit:
  description:
  entrypoint: pxgraphdb.py:export_import_repos_c5_ke2
  parameters:
    repos: ['Vestas-demo']
  work_pool:
    name: build
    work_queue_name:
    job_variables: {}
  enforce_parameter_schema: true
  schedules: []
- name: export-import-repos-graphs-c5-ke2
  version:
  tags: []
  concurrency_limit:
  description:
  entrypoint: pxgraphdb.py:export_import_repos_graphs_c5_ke2
  parameters:
    src_repo: Consumption-Navigator-001
    graphs: ['https://data.kaeser.com/KKH/GPH']
    tgt_repo: Vestas-demo
  work_pool:
    name: mercur
    work_queue_name:
    job_variables: {}
  enforce_parameter_schema: true
  schedules: []
- name: export-import-repos-ke2-ke-test
  version:
  tags: []
  concurrency_limit:
  description:
  entrypoint: pxgraphdb.py:export_import_repos_ke2_ke_test
  parameters:
    repos: ['Vestas-demo']
  work_pool:
    name: mercur
    work_queue_name:
    job_variables: {}
  enforce_parameter_schema: true
  schedules: []
- name: export-import-repos-graphs-ke2-ke-test
  version:
  tags: []
  concurrency_limit:
  description:
  entrypoint: pxgraphdb.py:export_import_repos_graphs_ke2_ke_test
  parameters:
    src_repo: Consumption-Navigator-001
    graphs: ['https://data.kaeser.com/KKH/GPH']
    tgt_repo: Vestas-demo
  work_pool:
    name: mercur
    work_queue_name:
    job_variables: {}
  enforce_parameter_schema: true
  schedules: []