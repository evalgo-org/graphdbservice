// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.960
package templates

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import (
	"evalgo.org/graphservice/auth"
	"fmt"
	"time"
)

func AuditLogs(user *auth.User) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Var2 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div class=\"card\"><h2>Audit Logs</h2><p style=\"margin-bottom: 1.5rem; color: var(--gray-700);\">View and search system audit logs. All user actions are logged with timestamps, IP addresses, and details.</p><!-- Filters --><div style=\"background: var(--gray-100); padding: 1rem; border-radius: 0.375rem; margin-bottom: 1.5rem;\"><form id=\"audit-filter-form\" onsubmit=\"loadAuditLogs(event)\"><div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;\"><div class=\"form-group\" style=\"margin-bottom: 0;\"><label for=\"filter-start-date\">Start Date</label> <input type=\"date\" id=\"filter-start-date\" name=\"start_date\" value=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var3 string
			templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(getDefaultStartDate())
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/audit.templ`, Line: 23, Col: 96}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "\"></div><div class=\"form-group\" style=\"margin-bottom: 0;\"><label for=\"filter-end-date\">End Date</label> <input type=\"date\" id=\"filter-end-date\" name=\"end_date\" value=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var4 string
			templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(getDefaultEndDate())
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/audit.templ`, Line: 27, Col: 90}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "\"></div><div class=\"form-group\" style=\"margin-bottom: 0;\"><label for=\"filter-username\">Username</label> <input type=\"text\" id=\"filter-username\" name=\"username\" placeholder=\"All users\"></div><div class=\"form-group\" style=\"margin-bottom: 0;\"><label for=\"filter-action\">Action</label> <select id=\"filter-action\" name=\"action\" style=\"width: 100%; padding: 0.75rem; border: 1px solid var(--gray-300); border-radius: 0.375rem;\"><option value=\"\">All actions</option> <option value=\"login\">Login</option> <option value=\"logout\">Logout</option> <option value=\"create_user\">Create User</option> <option value=\"update_user\">Update User</option> <option value=\"delete_user\">Delete User</option> <option value=\"change_password\">Change Password</option></select></div></div><div style=\"margin-top: 1rem; display: flex; gap: 1rem;\"><button type=\"submit\">Apply Filters</button> <button type=\"button\" onclick=\"resetFilters()\" style=\"background: var(--gray-300); color: var(--gray-800);\">Reset</button></div></form></div><!-- Audit Log List --><div id=\"audit-list\" hx-get=\"/admin/audit/list\" hx-trigger=\"load\" hx-swap=\"innerHTML\"><p>Loading audit logs...</p></div></div><style>\n\t\t\t.form-group {\n\t\t\t\tmargin-bottom: 1.25rem;\n\t\t\t}\n\t\t\t.form-group label {\n\t\t\t\tdisplay: block;\n\t\t\t\tfont-weight: 500;\n\t\t\t\tmargin-bottom: 0.5rem;\n\t\t\t\tcolor: var(--text-primary);\n\t\t\t\tfont-size: 0.875rem;\n\t\t\t}\n\t\t\t.form-group input[type=\"text\"],\n\t\t\t.form-group input[type=\"date\"] {\n\t\t\t\twidth: 100%;\n\t\t\t\tpadding: 0.75rem;\n\t\t\t\tborder: 1px solid var(--gray-300);\n\t\t\t\tborder-radius: 0.375rem;\n\t\t\t\tfont-size: 0.875rem;\n\t\t\t}\n\t\t\t.form-group input:focus {\n\t\t\t\toutline: none;\n\t\t\t\tborder-color: var(--primary);\n\t\t\t\tbox-shadow: 0 0 0 3px rgba(240, 90, 40, 0.1);\n\t\t\t}\n\t\t\t.audit-table {\n\t\t\t\twidth: 100%;\n\t\t\t\tborder-collapse: collapse;\n\t\t\t\tmargin-top: 1rem;\n\t\t\t\tfont-size: 0.875rem;\n\t\t\t}\n\t\t\t.audit-table th {\n\t\t\t\ttext-align: left;\n\t\t\t\tpadding: 0.75rem;\n\t\t\t\tbackground: var(--gray-100);\n\t\t\t\tborder-bottom: 2px solid var(--gray-300);\n\t\t\t\tfont-weight: 600;\n\t\t\t\tcolor: var(--text-primary);\n\t\t\t\twhite-space: nowrap;\n\t\t\t}\n\t\t\t.audit-table td {\n\t\t\t\tpadding: 0.75rem;\n\t\t\t\tborder-bottom: 1px solid var(--gray-200);\n\t\t\t\tvertical-align: top;\n\t\t\t}\n\t\t\t.audit-table tr:hover {\n\t\t\t\tbackground: var(--gray-100);\n\t\t\t}\n\t\t\t.audit-badge {\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tpadding: 0.25rem 0.75rem;\n\t\t\t\tborder-radius: 9999px;\n\t\t\t\tfont-size: 0.75rem;\n\t\t\t\tfont-weight: 600;\n\t\t\t\ttext-transform: uppercase;\n\t\t\t}\n\t\t\t.audit-badge.success {\n\t\t\t\tbackground: var(--success);\n\t\t\t\tcolor: white;\n\t\t\t}\n\t\t\t.audit-badge.error {\n\t\t\t\tbackground: var(--error);\n\t\t\t\tcolor: white;\n\t\t\t}\n\t\t\t.audit-timestamp {\n\t\t\t\tcolor: var(--gray-700);\n\t\t\t\tfont-size: 0.875rem;\n\t\t\t}\n\t\t\t.audit-details {\n\t\t\t\tfont-family: 'Courier New', monospace;\n\t\t\t\tfont-size: 0.75rem;\n\t\t\t\tcolor: var(--gray-700);\n\t\t\t\tmax-width: 300px;\n\t\t\t\toverflow: hidden;\n\t\t\t\ttext-overflow: ellipsis;\n\t\t\t}\n\t\t</style> <script>\n\t\t\tfunction loadAuditLogs(event) {\n\t\t\t\tif (event) event.preventDefault();\n\n\t\t\t\tconst form = document.getElementById('audit-filter-form');\n\t\t\t\tconst formData = new FormData(form);\n\t\t\t\tconst params = new URLSearchParams(formData);\n\n\t\t\t\thtmx.ajax('GET', '/admin/audit/list?' + params.toString(), {\n\t\t\t\t\ttarget: '#audit-list',\n\t\t\t\t\tswap: 'innerHTML'\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction resetFilters() {\n\t\t\t\tdocument.getElementById('audit-filter-form').reset();\n\t\t\t\tdocument.getElementById('filter-start-date').value = getDefaultStartDate();\n\t\t\t\tdocument.getElementById('filter-end-date').value = getDefaultEndDate();\n\t\t\t\tloadAuditLogs();\n\t\t\t}\n\n\t\t\tfunction getDefaultStartDate() {\n\t\t\t\tconst date = new Date();\n\t\t\t\tdate.setDate(date.getDate() - 7);\n\t\t\t\treturn date.toISOString().split('T')[0];\n\t\t\t}\n\n\t\t\tfunction getDefaultEndDate() {\n\t\t\t\treturn new Date().toISOString().split('T')[0];\n\t\t\t}\n\t\t</script>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = Layout("Audit Logs", user).Render(templ.WithChildren(ctx, templ_7745c5c3_Var2), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

func getDefaultStartDate() string {
	return time.Now().AddDate(0, 0, -7).Format("2006-01-02")
}

func getDefaultEndDate() string {
	return time.Now().Format("2006-01-02")
}

func AuditLogList(entries []auth.AuditEntry) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var5 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var5 == nil {
			templ_7745c5c3_Var5 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		if len(entries) == 0 {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "<p>No audit logs found for the selected criteria.</p>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		} else {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "<table class=\"audit-table\"><thead><tr><th>Timestamp</th><th>Username</th><th>Action</th><th>Resource</th><th>Status</th><th>IP Address</th><th>Details</th></tr></thead> <tbody>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			for _, entry := range entries {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "<tr><td class=\"audit-timestamp\">")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var6 string
				templ_7745c5c3_Var6, templ_7745c5c3_Err = templ.JoinStringErrs(entry.Timestamp.Format("2006-01-02 15:04:05"))
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/audit.templ`, Line: 198, Col: 54}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var6))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "</td><td>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var7 string
				templ_7745c5c3_Var7, templ_7745c5c3_Err = templ.JoinStringErrs(entry.Username)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/audit.templ`, Line: 200, Col: 26}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var7))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "</td><td>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var8 string
				templ_7745c5c3_Var8, templ_7745c5c3_Err = templ.JoinStringErrs(formatAction(entry.Action))
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/audit.templ`, Line: 201, Col: 38}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var8))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "</td><td>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var9 string
				templ_7745c5c3_Var9, templ_7745c5c3_Err = templ.JoinStringErrs(entry.Resource)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/audit.templ`, Line: 202, Col: 26}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var9))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "</td><td>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				if entry.Success {
					templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 11, "<span class=\"audit-badge success\">Success</span>")
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
				} else {
					templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 12, "<span class=\"audit-badge error\">Failed</span>")
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 13, "</td><td>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var10 string
				templ_7745c5c3_Var10, templ_7745c5c3_Err = templ.JoinStringErrs(entry.IPAddress)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/audit.templ`, Line: 210, Col: 27}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var10))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 14, "</td><td class=\"audit-details\">")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				if entry.ErrorMsg != "" {
					templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 15, "Error: ")
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					var templ_7745c5c3_Var11 string
					templ_7745c5c3_Var11, templ_7745c5c3_Err = templ.JoinStringErrs(entry.ErrorMsg)
					if templ_7745c5c3_Err != nil {
						return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/audit.templ`, Line: 213, Col: 31}
					}
					_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var11))
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
				} else if len(entry.Details) > 0 {
					var templ_7745c5c3_Var12 string
					templ_7745c5c3_Var12, templ_7745c5c3_Err = templ.JoinStringErrs(formatDetails(entry.Details))
					if templ_7745c5c3_Err != nil {
						return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/audit.templ`, Line: 215, Col: 38}
					}
					_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var12))
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
				} else {
					templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 16, "-")
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 17, "</td></tr>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 18, "</tbody></table><div style=\"margin-top: 1rem; color: var(--gray-700); font-size: 0.875rem;\">Showing ")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var13 string
			templ_7745c5c3_Var13, templ_7745c5c3_Err = templ.JoinStringErrs(fmt.Sprint(len(entries)))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/audit.templ`, Line: 225, Col: 37}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var13))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 19, " entries</div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		}
		return nil
	})
}

func formatAction(action string) string {
	switch action {
	case "login":
		return "Login"
	case "logout":
		return "Logout"
	case "create_user":
		return "Create User"
	case "update_user":
		return "Update User"
	case "delete_user":
		return "Delete User"
	case "change_password":
		return "Change Password"
	default:
		return action
	}
}

func formatDetails(details map[string]interface{}) string {
	if len(details) == 0 {
		return "-"
	}
	result := ""
	for key, value := range details {
		if result != "" {
			result += ", "
		}
		result += fmt.Sprintf("%s: %v", key, value)
	}
	if len(result) > 100 {
		return result[:97] + "..."
	}
	return result
}

var _ = templruntime.GeneratedTemplate
